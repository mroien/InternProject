NEG.Module("NEG.Widget.PropertyManager.ViewManager",function(){var h={BEFORE_PROPERTY_INIT:"Widget_PropertyManager_View_Before_Property_Init",AFTER_PROPERTY_INIT:"Widget_PropertyManager_View_After_Property_Init",BEFORE_PROPERTY_CHANGE:"Widget_PropertyManager_View_Before_Property_Change",AFTER_PROPERTY_CHANGE:"Widget_PropertyManager_View_After_Property_Change"},k=function(a,d){var c=this,g,i={};this.changeProperty=function(c,b){var e=NEG.cast([]);if(b)e.addRange(c.getSelectedProperties());else for(var a in i){var f=
i[a].getSelectedProperties();if(NEG.utility.isType(f,void 0)){e=NEG.cast([]);break}else e.addRange(f)}arguments=e.source;g.changeProperty(arguments)};this.on=function(a,b){var e=h[a];if(e&&b)NEG(c).on(e,b)};this.off=function(a,b){var e=h[a];e&&b&&NEG(c).off(e,b)};this.getDataModel=function(){return g};var j=function(a){for(var b in i){for(var e={selectedProperty:[],validValues:[],resultInfo:a.resultInfo},c=a.selectedProperty.length,f=0;f<c;f++){var d=a.selectedProperty[f];d.name==b&&e.selectedProperty.push(d)}c=
a.propertyStatus.length;for(f=0;f<c;f++)d=a.propertyStatus[f],d.name==b&&e.validValues.push(d.value);i[b].changeProperty(e)}};this.init=function(){g=a.modelBuilder(a,d);g.on("BEFORE_PROPERTY_INIT",function(d,b){NEG.cast(a.properties).each(function(a){a.viewModel.init(c);i[a.name]=a.viewModel});NEG(c).trigger(h.BEFORE_PROPERTY_INIT,b)});g.on("AFTER_PROPERTY_INIT",function(a,b){j(b);NEG(c).trigger(h.AFTER_PROPERTY_INIT,b)});g.on("BEFORE_PROPERTY_CHANGE",function(a,b){NEG(c).trigger(h.BEFORE_PROPERTY_CHANGE,
b)});g.on("AFTER_PROPERTY_CHANGE",function(a,b){j(b);NEG(c).trigger(h.AFTER_PROPERTY_CHANGE,b)});g.init(d.selectedProperties)}},l=function(a){var d=NEG.utility.isDefined(a.modelBuilder)&&NEG.utility.isDefined(a.properties)&&0<a.properties.length&&NEG.utility.isDefined(a.availableMap)&&0<a.availableMap.length;NEG.cast(a.properties).each(function(a){d=d&&NEG.utility.isDefined(a.viewModel)&&NEG.utility.isDefined(a.viewModel.init)&&NEG.utility.isDefined(a.viewModel.changeProperty)&&NEG.utility.isDefined(a.viewModel.getSelectedProperties)});
return d};return function(a,d){var c=null;l(a)&&(c=new k(a,d));return c}});
